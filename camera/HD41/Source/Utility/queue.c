/***************************************************************************************************
* FILE: queue.c

* DESCRIPTION:  --

* CREATED: 2017/9/22, by kevin xu
****************************************************************************************************
* MODIFY:  --

* DESCRIPTION: --

* DATE: --
***************************************************************************************************/

/***************************************************************************************************
* INCLUDE FILES
***************************************************************************************************/
#include "queue.h"
#include <stdlib.h>
/***************************************************************************************************
* LOCAL DEFINES
***************************************************************************************************/

/***************************************************************************************************
* LOCAL GLOBAL VARIABLES
***************************************************************************************************/

/***************************************************************************************************
* FUNCTION DECLARATION
***************************************************************************************************/

/***************************************************************************************************
* Description:  初始化队列
* Arguments:    *pQueue：队列二级指针
*               *buf：队列缓存
*               *size：队列大小
* Returns:      0：初始化成功
*               1：参数错误，失败
*               2：内存分配失败
***************************************************************************************************/
uint8_t ByteQueue_Init(pByteQueue pQueue, uint8_t *buf, unsigned short size)
{
    if ((pQueue == NULL) || (buf == NULL) || (size < 1))
    {
        return 1; //传入参数错误，初始化失败。
    }
    pQueue->front = 0;
    pQueue->rear = 0;
    pQueue->count = 0;
    pQueue->size = size;  //队列大小
    pQueue->buffer = buf; //队列缓存地址
    return 0;
}
/***************************************************************************************************
* Description:  清空队列
* Arguments:    pQueue：队列指针
* Returns:      void
***************************************************************************************************/
void ByteQueue_Clear(pByteQueue pQueue)
{
    pQueue->front = pQueue->rear = pQueue->count = 0;
}
/***************************************************************************************************
* Description:  判断是否为空
* Arguments:    pQueue：队列指针
* Returns:      0：不为空 1：空
***************************************************************************************************/
uint8_t ByteQueue_IsEmpty(pByteQueue pQueue)
{
    if (pQueue->count == 0)
        return 1;
    else
        return 0;
}
/***************************************************************************************************
* Description:  数据入队
* Arguments:    pQueue：队列指针
*               data：数据
* Returns:      void
***************************************************************************************************/
void ByteQueue_EnQueue(pByteQueue pQueue, uint8_t data)
{
    if (pQueue->count < pQueue->size)
    {
        pQueue->count++;
        pQueue->buffer[pQueue->rear] = data;
        pQueue->rear = (pQueue->rear + 1) % pQueue->size;
    }
    else
    {
//        pQueue->front = (pQueue->front + 1) % pQueue->size;
    }
}
/***************************************************************************************************
* Description:  出队
* Arguments:    pQueue：队列指针
*               *data：数据指针
* Returns:      0：成功 1：队列为空，出队失败
***************************************************************************************************/
uint8_t ByteQueue_DeQueue(pByteQueue pQueue, uint8_t *data)
{
    if (pQueue->count > 0)
    {
        pQueue->count--;
        *data = pQueue->buffer[pQueue->front];
        pQueue->front = (pQueue->front + 1) % pQueue->size;

        return 1;
    }
    return 0;//队列为空
}

/****************************************** END OF FILE *******************************************/
